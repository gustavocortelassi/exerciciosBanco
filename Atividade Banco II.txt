create database controledelivrosFinal;
use controledelivrosFinal;


create table autor(
id_autor int primary key,
nome varchar(50),
idade int,
valor_hr decimal(10,2)
);

create table editora(
id_editora int primary key,
nome varchar(50),
telefone varchar(12)
);

create table estilo(
id_estilo int primary key,
nome varchar(50)
);

create table livro(
id_livro int primary key,
titulo varchar(50),
id_editora int,
valor decimal(10,2),
constraint fk_livro_editora foreign key (id_editora) references editora(id_editora)
);

create table livro_autor(
	id_autor int,
    id_livro int,
    primary key(id_autor,id_livro),
    foreign key (id_autor) references autor(id_autor),
    foreign key (id_livro) references livro(id_livro)
    
);

create table livro_estilo(
	id_estilo int,
    id_livro int,
    primary key(id_livro,id_estilo),
    foreign key (id_livro) references livro(id_livro),
    foreign key (id_estilo) references estilo(id_estilo)
    
);

insert into editora values
(1,'Abril','1234567'),
(2,'Globo','12345'),
(3,'Saraiva','1233451212'),
(4,'BBBBB','12345'),
(5,'CCCC','12334521312'),
(6,'EEEE','12334521312'),
(7,'FFF','12334521312'),
(8,'GGGG','12334521312');

insert into autor values
(1,'Paulo Coelho',70,120.3),
(2,'Agatha Christie',50,120.3),
(3,'J K Rowling',70,120.3),
(4,'Dan Brown',35,120.3),
(5,'J R R Tolkien',70,120.3),
(6,'João Abreu',25,5.3),
(7,'Pedro Maria',35,20.3);

insert into estilo values
(1,'Comédia'),
(2,'Drama'),
(3,'Ficção'),
(4,'Suspense'),
(5,'Romance'),
(6,'Ação'),
(7,'Terror');

insert into livro values
(1,'Livro - 123',1,1.5),
(2,'Livro - 234',2,2.5),
(3,'Livro - 333',3,5.5),
(4,'Livro - 444',4,12.5),
(5,'Livro - 555',5,15.5),
(6,'Livro - 566',5,20.5),
(7,'Livro - 544',5,10.5),
(8,'Livro - 666',5,15.5),
(9,'Livro - 777',5,20.5);

insert into livro_autor values
(1,1),
(2,2),
(3,3),
(4,4),
(5,5),
(2,6),
(5,7),
(5,8),
(5,9);

insert into livro_estilo values
(1,1),
(2,2),
(3,3),
(4,4),
(5,5),
(5,6),
(2,7),
(2,8),
(2,9);

/* Consultar titulo livro, nome editora, nome estilo e nome autor; */
SELECT
    livro.titulo,
    editora.nome AS editora,
    estilo.nome AS estilo,
    autor.nome AS autor
FROM
    livro
INNER JOIN
    editora ON livro.id_editora = editora.id_editora
INNER JOIN
    livro_autor ON livro.id_livro = livro_autor.id_livro
INNER JOIN
    autor ON livro_autor.id_autor = autor.id_autor
INNER JOIN
    livro_estilo ON livro.id_livro = livro_estilo.id_livro
INNER JOIN
    estilo ON livro_estilo.id_estilo = estilo.id_estilo;

/* Consultar titulo livro, nome editora. Onde o telefone da editora seja igual a 12345; */
SELECT
    livro.titulo,
    editora.nome AS editora
FROM
    livro
INNER JOIN
    editora ON livro.id_editora = editora.id_editora
WHERE
	editora.telefone = '12345';

/* Consultar titulo livro, nome autor. Onde autor tenha idade igual a 35;*/
SELECT
    livro.titulo,
    autor.nome
FROM
    livro
INNER JOIN
    livro_autor ON livro.id_livro = livro_autor.id_livro
INNER JOIN
    autor ON livro_autor.id_autor = autor.id_autor
WHERE
    autor.idade = 35;
    
/*Consultar titulo livro, nome autor e editora. Onde autor tenha o nome de Dan Brown*/
SELECT
	livro.titulo,
    autor.nome,
    editora.nome
FROM 
	livro
INNER JOIN
    livro_autor ON livro.id_livro = livro_autor.id_livro
INNER JOIN
    autor ON livro_autor.id_autor = autor.id_autor
INNER JOIN
	editora ON livro.id_editora = editora.id_editora
WHERE
	autor.nome = 'Dan Brown';
    
/*Consultar titulo livro, nome autor e editora. Onde autor tenha o nome de Dan Brown
e idade igual a 35*/
SELECT
	livro.titulo,
    autor.nome,
    editora.nome
FROM 
	livro
INNER JOIN
    livro_autor ON livro.id_livro = livro_autor.id_livro
INNER JOIN
    autor ON livro_autor.id_autor = autor.id_autor
INNER JOIN
	editora ON livro.id_editora = editora.id_editora
WHERE
	autor.nome = 'Dan Brown' AND autor.idade = 35;
	
/*Consultar titulo livro, nome autor e editora. Onde autor tenha o nome de Dan Brown
ou editora com o telefone igual a 12345;*/
SELECT
	livro.titulo,
    autor.nome,
    editora.nome
FROM 
	livro
INNER JOIN
    livro_autor ON livro.id_livro = livro_autor.id_livro
INNER JOIN
    autor ON livro_autor.id_autor = autor.id_autor
INNER JOIN
	editora ON livro.id_editora = editora.id_editora
WHERE
	autor.nome = 'Dan Brown' AND editora.telefone = 12345;
    
/*Consulta titulo livro, nome estilo dos livros do estilo Romance;*/
SELECT
	livro.titulo,
	estilo.nome
FROM
	livro
INNER JOIN
	livro_estilo ON livro.id_livro = livro_estilo.id_livro
INNER JOIN
	estilo ON livro_estilo.id_estilo = estilo.id_estilo
WHERE 
	estilo.nome = 'Romance';
    
/*Consulta titulo livro, nome estilo dos livros da editora Globo;*/
SELECT
	livro.titulo,
	estilo.nome,
    editora.nome
FROM
	livro
INNER JOIN
	livro_estilo ON livro.id_livro = livro_estilo.id_livro
INNER JOIN
	estilo ON livro_estilo.id_estilo = estilo.id_estilo
INNER JOIN
	editora ON livro.id_editora = editora.id_editora
WHERE 
	editora.nome = 'Globo';
    
/*Consultar apenas os autores que não possuem nenhum livro;*/
SELECT 
    autor.*
FROM 
    autor
LEFT JOIN 
    livro_autor ON autor.id_autor = livro_autor.id_autor
WHERE 
    livro_autor.id_autor IS NULL;

/*Consultar apenas as editoras que não possuem nenhum livro;*/
SELECT 
    editora.*
FROM 
    editora
LEFT JOIN 
    livro ON editora.id_editora = livro.id_editora
WHERE 
    livro.id_livro IS NULL;

/*Consultar apenas os estilo que não possuem nenhum livro;*/
SELECT
	estilo.*
FROM
	estilo
LEFT JOIN
	livro_estilo ON estilo.id_estilo = livro_estilo.id_estilo
WHERE
	livro_estilo.id_estilo IS NULL;
